\" Define project URL
.ds lcovurl https://github.com/linux\-test\-project/lcov

.TH diffcov 1 "LCOV 2.0" 2023\-05\-17 "User Manuals"
.SH NAME
diffcov \- an extension of open-cource LCOV to support differential categorization and date/owner binning

.SH SYNOPSIS

Capture and display (as HTML) coverage data generated by your compiler toolchain.

.SH Release notes:
.br

.B diffcov/2.0.22 (6 October 2022):
.br

.RS 3
Compared to diffcov/2.0.21:

.IP \- 3
Changes related to error checking and error handling:
.RS 3
.IP \- 3
Return non-zero exit code if error is detected when
.I \-\-keep\-going
flag is specified.  (Tool will continue execution in the presence of errors but will return an exit status.) See the
.I stop_on_error
entry in the
.B lcovrc
man page.
.PP

.IP \- 3
Check that file version matches before applying filtering.
.PP

.IP \- 3
Add new error message types:

.RS 3
.IP o 3
.B internal
A situation which is not supposed to happen was detected - but I think
that it is safe to continue if you ignore the error.
However, please report the bug so that it can be diagnosed and fixed.

.IP o 3
.B parent
for the case that the parent process vanishes during
.I \-\-parallel
execution.  This is usually because the parent has detected a fatal error -
.I e.g.,
an error which was not ignored from another child.

.IP o 3
.B child
child process returned non-zero exit code during
.I \-\-parallel
execution.  This typically indicates that the child encountered an error:  see the log file immediately above this message.
In contrast:  the
.B parallel
error indicates an unexpected/unhandled exception in the child process - not a 'typical' lcov error.

.IP o 3
.B range
for the case of out-of-range location message.  Fomerly, this had been
reported by message type
.I source
- which was also used when the source file could not be found.
Out-of-range lines can be caused by a bug in gcc or llvm (wrong data
reported in generated code) or could be due to a source code version
mismatch.
.PP

.IP o 3
.B usage
which is used to report usage errors - e.g., unsupported option combinations.

.IP o 3
.B utility
for the case that a utility called by diffcov (e.g., 'find') returns
an error code.

.RE

.IP \- 3
Add additional error checking to diff-file processing.  Add ability to ignore detected errors.  (Errors are often due to substituion patterns which are broader than the user anticipated.)

.IP \- 3
Add message count summary at the end of processing.
.PP

.IP \- 3
Add config file option
.I warn_once_per_file = 0|1
to tell the tools to certain warning types only once per file (rather than on
each occurence of the issue in the file).
Default is 1 (disable additional warnings).
.PP

.IP \- 3
Add config file option
.I check_existence_before_callback = 0|1
to tell the tools to warn about missing files before calling the
.I \-\-version\-script
or
.I \-\-annotate\-script
callback.  Default is 1 (check for existence).  See the
.B lcovrc
man page for details.

.IP \- 3
Clean up message handling to use consistent formatting for all ignorable errors and warnings.
.PP
.RE

.IP \- 3
.RB genhtml
changes:

.RS

.IP \- 3
Clarify summary table sort keys in HTML output, add tooltip popups to additional navigation links
.PP

.IP \- 3
Use different background color for directory names vs file names in summary table in
.I genhtml --hierarchical
output.
.PP

.IP \- 3
Apply
.I \-\-substitute
patterns to
.I \-\-diff\-file
entries in genhtml.
.PP

.IP \- 3
Append synthesized content to detail source if there are out-of-range
coverpoints in the corresponding file.
.PP

.IP \- 3
Allow genhtml with diff file but no baseline data:  assume that nothing was covered in baseline.  This enables you to see UNC/UIC/GNC/GIC categorization for code that changed since your baseline - e.g., if it is not easy to go back to generate the baseline coverage data.
.PP

.IP \- 3
Enable
.I \-\-annotate\-script
callback to return both 'abbreviated' and 'full' author name.
See the
.B genhtml
and
.B lcovrc
man pages.
.PP
.RE

.IP \- 3
Add Additional components to install module:
.RS 3
.IP \- 3
Add example to install module - path is $(DIFFCOV_HOME)/share/lcov/example.
.PP

.IP \- 3
Add diffcov regression test suite to install module - path is $(DIFFCOV_HOME)/share/lcov/tests.
.br
To execute:
.br
.RI "   \[Do] cp -r $DIFFCOV_HOME/share/lcov/tests myTestDir"
.br
.RI "   \[Do] cd myTestdir"
.br
.RI "   \[Do] make LCOV_HOME=$DIFFCOV_HOME [COVERAGE=1]"
.PP
.RE

.IP \- 3
Improved handling of carriage return in data files (windows/mac portability).
.PP

.IP \- 3
Add
.I \-\-source\-directory
option to
.B lcov
and
.B geninfo.
This option tells the tool to look for source files which have relative paths in several possible locations.

.PP .IP \- 3
Warn if
.I \-`-source\-directory
 or
.I \-\-build\-directory
elements are not used.
.PP


.RE

.B diffcov/2.0.21 (17 August 2023):
.br

.RS 3
Compared to diffcov/2.0.20:

.IP \- 3
Support for set operations 'intersect' and 'difference' on coverage data (.info files).
.br
See the
.I \-\-intersect
and
.I \-\-subtract
descriptions in the
.B lcov
man page.

.PP
.IP \- 3
Improved error checking in sample revision control integration scripts (
gitblame, p4udiff, etc.

.PP
.IP \- 3
Improved version handling for files that are not checked in to git or p4 (e.g., generated files that are included in the coverage report)

.PP
.IP \- 3
Added
.B gitversion
sample script to the
.B $(DIFFCOV_HOME)/share/lcov/support-scripts
directory - to enable version checking of files found in GIT.
.br
See the
.I \-\-version\-script
details in the
.B genhtml
man page.

.PP
.IP \- 3
Show 'negative hit count' in source code detail view for coverpoints in
.I LBC
and
.I ECB
categories.  We know that the 'current' count is zero (LBC) or not defined (ECB);  so show the 'baseline' hit count enclosed in parens.  Particularly in a random test environment, it may be useful to know whether a low probability event did not happen (loss is a "small" number) or if something bad happened and a formerly high probability event no longer occurs.


.IP \- 3
Substantially faster
.I lcov \-capture ...
operations - especially if you have a large number of GCDA/GCNO files and a large number of source files.
.br
Also see the
.B lcovrc
man page for a description of some additional parameters which may help to further
improve performance if the default settings prove to be insufficient:
.I geninfo_chunk_size \,
.I geninfo_interval_update \,
.I lcov_filter_parallel \,
and
.I lcov_filter_chunk_size.

.PP

.IP \- 3
Support for multiple 'baseline' and/or multiple 'current' coverage input files
.RS 3
.IP o 3
This is useful if you have multiple test suites (say), and you want to generate reports which compare both individual suite coverage as well as cumulative coverage.
(You would not need to create and manage aggregate reports.)
.PP
.RE
.PP
.IP \- 3
Support for comments in generated .info files
.br
Comments may be useful to help manage your historical coverage data
.PP
.IP \- 3
Various other documentation updates, small changes and bug fixes
.PP

.IP \- 3
Add this
.B diffcov
man page - to hold release notes and other information.

.RE
.RE

.B diffcov/2.0.20 (22 June 2023):
.br

.RS 3
Compared to diffcov/2.0.19:
.IP \- 3
Added
.I lcov \-capture \-\-build\-directory ...
option.
.RS 3
.IP o 3
The new parameter gives a way to tell the tool where to find your
.I .gcno
files (compile-time coverage data) if they are not in the same place as your
.I .gcda
files (runtime coverage data).
.br
Files can be in different places because you used the gcc/llvm GCOV_PREFIX environment variable, or for a couple of other reasons.
.PP
.RE
.PP

.IP \- 3
changed callback callback interface (for annotate, version, and criteria scripts, as well as for
.B gcov\-tool
and
.B cpp-demangle-tool
.RS 3
.IP o 3
these now work like gcc's
.I \-Xlinker
argument, and make it easier to integrate certain tools (especially on Windows, if there are spaces in tool path names)
.PP
.RE
.PP

.RE
.RE

.B Older diffcov versions:
.br
.RS 3
I no longer recall the precise differences.  Please ask, if you really need to know.
.RE

.br
.SH AUTHOR
Henry Cox <henry.cox@mediatek.com>

.SH SEE ALSO
.BR lcov (1)
.BR genhtml (1),
.BR geninfo (1),
.BR genpng (1),
.BR gendesc (1),
.BR lcovrc (5),
.BR gcov (1)
.br

.I \*[lcovurl]
.br
